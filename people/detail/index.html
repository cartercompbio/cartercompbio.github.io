<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Team Member - The Carter Lab</title>
    <link rel="stylesheet" href="../../styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        .member-detail {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
        }

        .member-header {
            text-align: center;
            margin-bottom: 3rem;
            padding-bottom: 2rem;
            border-bottom: 3px solid #1e748a;
        }

        .member-photo {
            width: 250px;
            height: 250px;
            border-radius: 50%;
            object-fit: cover;
            margin: 0 auto 1.5rem;
            display: block;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            background-color: #e0e0e0;
        }

        .member-name {
            font-size: 2.5rem;
            color: #1e748a;
            margin-bottom: 0.5rem;
        }

        .member-position {
            font-size: 1.3rem;
            color: #666;
            font-style: italic;
            margin-bottom: 0.5rem;
        }

        .member-program {
            font-size: 1.1rem;
            color: #1e748a;
            margin-bottom: 0.5rem;
        }

        .member-affiliation {
            font-size: 1.1rem;
            color: #888;
        }

        .member-links {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            margin-top: 1rem;
        }

        .member-link-badge {
            display: inline-block;
            padding: 0.5rem 1rem;
            background: #1e748a;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            font-size: 0.9rem;
            font-weight: 600;
            transition: background 0.3s, transform 0.2s;
        }

        .member-link-badge:hover {
            background: #26a3ba;
            transform: translateY(-2px);
            text-decoration: none;
        }

        .member-section {
            background: #f8f9fa;
            padding: 2rem;
            border-radius: 8px;
            margin-bottom: 2rem;
        }

        .member-section h2 {
            color: #1e748a;
            font-size: 1.8rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .member-section ul {
            list-style: none;
            padding-left: 0;
        }

        .member-section li {
            padding: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
            line-height: 1.6;
        }

        .member-section li:before {
            content: "‚ñ∏";
            color: #1e748a;
            font-weight: bold;
            position: absolute;
            left: 0;
        }

        .member-bio {
            font-size: 1.1rem;
            line-height: 1.8;
            color: #333;
        }

        .member-contact {
            text-align: center;
            padding: 1.5rem;
            background: #1e748a;
            color: white;
            border-radius: 8px;
        }

        .member-contact a {
            color: white;
            font-size: 1.2rem;
            text-decoration: none;
            font-weight: 600;
        }

        .member-contact a:hover {
            text-decoration: underline;
        }

        .back-link {
            display: inline-block;
            margin-bottom: 2rem;
            color: #1e748a;
            text-decoration: none;
            font-weight: 600;
        }

        .back-link:hover {
            text-decoration: underline;
        }

        .back-link:before {
            content: "‚Üê ";
        }

        .loading {
            text-align: center;
            padding: 4rem;
            color: #666;
        }

        .error {
            text-align: center;
            padding: 4rem;
            color: #d32f2f;
        }

        .radar-chart-container {
            text-align: center;
            margin-top: 1rem;
        }

        .radar-chart {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body>
    <header class="site-header" style="height: 200px;">
        <div class="header-image" style="background-image: url('../../assets/images/homepage.webp'); height: 200px;">
            <div class="header-overlay">
                <h1 class="site-title" style="font-size: 2.5rem;">The Carter Lab</h1>
            </div>
        </div>
    </header>

    <nav class="main-nav">
        <a href="../../index.html#home">Home</a>
        <a href="../../index.html#research">Research</a>
        <a href="../../index.html#people">People</a>
        <a href="../../index.html#software">Software</a>
        <a href="../../index.html#publications">Publications</a>
        <a href="../../index.html#contact">Contact</a>
    </nav>

    <div class="container">
        <div class="member-detail">
            <a href="../../index.html#people" class="back-link">Back to People</a>

            <div id="member-content">
                <div class="loading">Loading member information...</div>
            </div>
        </div>
    </div>

    <footer class="site-footer">
        <p>&copy; 2025 The Carter Lab, UC San Diego. All rights reserved.</p>
    </footer>

    <script>
        // Get member ID from URL parameter
        const urlParams = new URLSearchParams(window.location.search);
        const memberId = urlParams.get('id');

        async function loadMemberDetails() {
            const contentDiv = document.getElementById('member-content');

            if (!memberId) {
                contentDiv.innerHTML = '<div class="error">No member ID specified.</div>';
                return;
            }

            try {
                // Load individual profile
                const response = await fetch(`../profiles/${memberId}.json?_=${Date.now()}`);

                if (!response.ok) {
                    contentDiv.innerHTML = '<div class="error">Member not found.</div>';
                    return;
                }

                const member = await response.json();

                // Update page title
                document.title = `${member.name} - The Carter Lab`;

                // Generate photo path
                const photoPath = member.photo
                    ? `../../assets/images/people/${member.photo}`
                    : 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="250" height="250"%3E%3Crect fill="%23e0e0e0" width="250" height="250"/%3E%3Ctext x="50%25" y="50%25" dominant-baseline="middle" text-anchor="middle" font-family="sans-serif" font-size="18" fill="%23999"%3EPhoto%3C/text%3E%3C/svg%3E';

                // Build the page content
                let html = `
                    <div class="member-header">
                        <img src="${photoPath}" alt="${member.name}" class="member-photo" />
                        <h1 class="member-name">${member.name}</h1>
                        ${member.position ? `<p class="member-position">${member.position}</p>` : ''}
                        ${member.program ? `<p class="member-program">Program: ${member.program}</p>` : ''}
                        ${member.affiliation ? `<p class="member-affiliation">${member.affiliation}</p>` : ''}
                    </div>
                `;

                // Bio section
                if (member.bio) {
                    html += `
                        <div class="member-section">
                            <h2>About</h2>
                            <p class="member-bio">${member.bio}</p>
                        </div>
                    `;
                }

                // Interests section
                if (member.interests && member.interests.length > 0) {
                    html += `
                        <div class="member-section">
                            <h2>üîç Research Interests</h2>
                            <ul>
                                ${member.interests.map(interest => `<li>${interest}</li>`).join('')}
                            </ul>
                        </div>
                    `;
                }

                // Education section
                if (member.education && member.education.length > 0) {
                    html += `
                        <div class="member-section">
                            <h2>üéì Education</h2>
                            <ul>
                                ${member.education.map(edu => `<li>${edu}</li>`).join('')}
                            </ul>
                        </div>
                    `;
                }

                // Contact section
                if (member.email || (member.links && member.links.length > 0)) {
                    html += `<div class="member-section"><h2>üìß Contact</h2>`;

                    if (member.email) {
                        html += `<p><strong>Email:</strong> <a href="mailto:${member.email}">${member.email}</a></p>`;
                    }

                    if (member.links && member.links.length > 0) {
                        html += `<div class="member-links">`;
                        member.links.forEach(link => {
                            html += `<a href="${link.url}" target="_blank" class="member-link-badge">${link.type}</a>`;
                        });
                        html += `</div>`;
                    }

                    html += `</div>`;
                }

                // Radar chart section
                if (member.radar_data) {
                    html += `
                        <div class="member-section">
                            <h2>üìä Skills & Interests Radar</h2>
                            <div class="radar-chart-container">
                                <canvas id="radarChart" width="400" height="400"></canvas>
                            </div>
                        </div>
                    `;
                }

                contentDiv.innerHTML = html;

                // Render radar chart if data exists
                if (member.radar_data) {
                    const ctx = document.getElementById('radarChart');
                    new Chart(ctx, {
                        type: 'radar',
                        data: {
                            labels: member.radar_data.labels,
                            datasets: [{
                                label: member.name,
                                data: member.radar_data.values,
                                fill: true,
                                backgroundColor: 'rgba(30, 116, 138, 0.2)',
                                borderColor: 'rgba(30, 116, 138, 1)',
                                borderWidth: 2,
                                pointBackgroundColor: 'rgba(30, 116, 138, 1)',
                                pointBorderColor: '#fff',
                                pointHoverBackgroundColor: '#fff',
                                pointHoverBorderColor: 'rgba(30, 116, 138, 1)'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: true,
                            scales: {
                                r: {
                                    beginAtZero: true,
                                    min: 0,
                                    max: 10,
                                    ticks: {
                                        stepSize: 2,
                                        font: {
                                            size: 12
                                        }
                                    },
                                    pointLabels: {
                                        font: {
                                            size: 14
                                        }
                                    }
                                }
                            },
                            plugins: {
                                legend: {
                                    display: false
                                }
                            }
                        }
                    });
                }

            } catch (error) {
                console.error('Error loading member details:', error);
                contentDiv.innerHTML = '<div class="error">Error loading member information.</div>';
            }
        }

        // Load member details when page loads
        document.addEventListener('DOMContentLoaded', loadMemberDetails);
    </script>
</body>
</html>
